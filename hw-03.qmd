---
title: "HW 03"
author: "Brooke Pacheco"
format:
  html:
    embed-resources: true
toc: true
---
## 0 - Setup

```{r setup}
# load packages
library(tidyverse)
library(glue)
library(here)
library(countdown)
library(ggthemes)
library(gt)
library(openintro)
library(ggrepel)
library(patchwork)

# set theme for ggplot2
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# set width of code output
options(width = 65)

# set figure parameters for knitr
knitr::opts_chunk$set(
  fig.width = 7,        # 7" width
  fig.asp = 0.618,      # the golden ratio
  fig.retina = 3,       # dpi multiplier for displaying HTML output on retina
  fig.align = "center", # center align figures
  dpi = 300             # higher dpi, sharper image
)

if (!require("pacman")) 
  install.packages("pacman")

# use this line for installing/loading
pacman::p_load(tidyverse,
               glue,
               scales,
               ggthemes) 

devtools::install_github("tidyverse/dsbox")

```

## 1 - Du Bois challenge.

```{r}
#| label: Recreation of Du Bois Plot

# Read in data from income file
income <- read_csv(here("data" ,"income.csv"))

income <- income |>
  pivot_longer(
    cols = c(Rent, Food, Clothes, Tax, Other),
    names_to = "Type",
    values_to = "Total_Amount"
  ) |>
  mutate(
    Type = factor(Type, levels = c("Other", "Tax", "Clothes", "Food", "Rent")),
    Class = factor(Class, levels = c("$1000 AND OVER", "$750-1000", "$500-750", "$400-500", "$300-400", "$200-300", "$100-200")),
    Percent = round((Total_Amount / Average_Income) * 100)
  ) |>
  glimpse()

# Create the histogram plot
ggplot(income, aes(x = Total_Amount, y = Class, fill = Type)) +
  geom_col(position = "stack") +
  scale_fill_manual(
    values = c("Rent" = "#000000", "Food" = "#C3B1E1", "Clothes" = "#F89880", "Tax" = "#B7C9E2", "Other" = "#E6ECF5")) +
  geom_text(
    aes(label = percent(Percent)),
    position = position_stack(vjust = 0.5),
    color = "black",
    size = 3
  ) +
  labs(
    title = "Du Bois Plot Recreation",
    x = "Amount Spent",
    y = "Income Class"
  ) +
  theme_minimal(base_size = 11)

```
### Sources
hex color values:
https://htmlcolorcodes.com/colors/

## 2 - COVID survey - interpret

#### Example 1:
For the response variable "Getting the vaccine will make me feel safer at work", nurses had an average response close to 1, with a relatively narrow confidence interval. This indicates that most nurses agreed with the statement, and the estimate is fairly precise. Medical professionals, on the other hand, had a mean closer to 2 with a wider confidence interval. This suggests that while medical professionals also tended to agree, they were on average slightly less certain than nurses. Additionally, the wider confidence interval for medical professionals indicates greater variability in their responses and less precision in the estimate compared to the nurses. The responses did surprise me. I initially thought that medical professionals might be more confident than nurses because they typically have more training. However, on second thought, the confidence interval for the medical professionals group is much wider, suggesting greater variability and less precision in their responses.

#### Example 2:
For the response variable "I am concerned about the safety and side effects of the vaccine", the Non-Hispanic/Non-Latino group has a slightly higher mean (around 3.5) with a relatively wide confidence interval. The Hispanic/Latino group has a mean closer to 3, also with a wide confidence interval. Notably, the confidence interval for the Non-Hispanic/Non-Latino group is slightly wider than that of the Hispanic/Latino group. These results suggest that, on average, both groups are neutral in their concern about the vaccine's safety and side effects. However, the wide confidence intervals indicate a fair amount of uncertainty around these means, making the estimates less precise. Though the overlap between intervals suggests no statistically significant difference between the two groups. The results do not surprise me; regardless of ethnicity, I would expect both groups to have similar opinions.

#### Example 3:
For the response variable "I trust the information that I have received about the vaccines", the group that reported having received the COVID vaccine had a mean close to 1, with a narrow confidence interval. This indicates strong agreement with the statement and a high level of precision in the estimate. In contrast, the group that reported not having received the vaccine had a mean around 3, with a wide confidence interval. This suggests that those who were unvaccinated were generally neutral in their trust of vaccine information, and the wide confidence interval reflects greater uncertainty and less precision in this group's response. The results make sense; I would expect unvaccinated individuals to be less confident in the information compared to those who have received the vaccine.

## 3 - COVID survey - reconstruct

```{r}
#| label: Reconstruct COVID Survey 

# Read in data from COVID survey file
covid_survey <- read_csv(here("data" ,"covid-survey.csv")) 

covid_survey |>
  glimpse()

head(covid_survey)

dim(covid_survey)

```


## 4 - COVID survey - re-reconstruct

## 5 - COVID survey - another view
